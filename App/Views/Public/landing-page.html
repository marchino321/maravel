<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>FamilyNest â€“ In apertura</title>
  <meta name="description" content="FamilyNest Ã¨ in apertura. Nessun abbonamento obbligatorio.">

  <link rel="stylesheet" href="/App/public/AssetsSite/style.css">
</head>

<body>

  <div class="app-card landing-page">

    <!-- LOGO -->
    <div class="top-bar">
      <a class="top-bar-logo" href="#">
        <img src="{{Logo}}" alt="FamilyNest">
      </a>
    </div>

    <h1>FamilyNest Ã¨ in apertura</h1>

    <p class="subtitle">
      Stiamo creando uno spazio di fiducia<br>
      tra famiglie e persone che si prendono cura di loro.<br><br>

      <strong>Nessun abbonamento obbligatorio.</strong><br>
      Il profilo su FamilyNest sarÃ  gratuito.
    </p>


    <hr class="section-divider">

    <section class="contact-section">
      <div id="titoloLandingPage">
        <h2>Chi sei?</h2>

        <div class="trust-actions">
          <button type="button" class="cta-secondary cta-family role-btn active" data-role="famiglia">
            ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Sono una famiglia
          </button>

          <button type="button" class="cta-secondary cta-caregiver role-btn" data-role="caregiver">
            <span class="cta-title">ğŸ’› Persona di fiducia</span>
            <span class="cta-subtitle">
              Babysitter Â· Dogsitter Â· Assistenza anziani Â· Collaborazione domestica
            </span>
          </button>
        </div>
      </div>


      <form class="contact-form" id="leadForm">
        <input type="hidden" id="tipo_utente" value="famiglia">

        <div class="form-field">
          <label>Nome <span style="color: red;">*</span></label>
          <input type="text" name="nome" required placeholder="Inserisci il tuo nome">
        </div>

        <div class="form-field">
          <label>Email <span style="color: red;">*</span></label>
          <input type="email" name="email" required placeholder="Inserisci la tua email">
        </div>

        <div class="form-field phone-row">

          <select class="form-select" id="prefisso" name="prefissoTelefono">
            <option value="+39" selected>ğŸ‡®ğŸ‡¹ +39</option>
            <option value="+1">ğŸ‡ºğŸ‡¸ +1</option>
            <option value="+33">ğŸ‡«ğŸ‡· +33</option>
            <option value="+34">ğŸ‡ªğŸ‡¸ +34</option>
            <option value="+41">ğŸ‡¨ğŸ‡­ +41</option>
            <option value="+44">ğŸ‡¬ğŸ‡§ +44</option>
            <option value="+49">ğŸ‡©ğŸ‡ª +49</option>
            <!-- se vuoi, poi ne aggiungiamo altri -->
          </select>

          <input type="tel" class="form-control" name="telefono" id="telefono" placeholder="Numero di cellulare"
            inputmode="numeric" pattern="[0-9]{9,10}" required>

        </div>

        <div class="form-field">
          <label>CittÃ  / Provincia <span style="color: red;">*</span></label>
          <input type="text" name="citta" required placeholder="Inserisci la cittÃ  dove abiti">
        </div>

        <div class="form-field" id="servizioBox">
          <label id="servizioLabel">Servizio offerto <span style="color: red;">*</span></label>
          <select name="servizio">
            <option value="">Seleziona</option>
            <option value="babysitter">Babysitter</option>
            <option value="dogsitter">Dogsitter</option>
            <option value="assistenza_anziani">Assistenza anziani</option>
            <option value="collaborazione_domestica">Collaborazione domestica</option>
          </select>
        </div>
        <p class="profile-note">
          Ti scriveremo solo per aggiornarti sullâ€™apertura ğŸŒ¿
          Nessun costo Â· Nessun abbonamento Â· Nessun vincolo</p>

        <div class="trust-actions"></div>
        <button type="submit" class="cta-button">
          Resta in contatto con FamilyNest
        </button>




      </form>

      <div id="successMessage" class="hidden" style="text-align:center; margin-top:30px;">
        <h2>âœ… Grazie!</h2>
        <p>Ti avviseremo non appena FamilyNest sarÃ  online.</p>
      </div>

    </section>

  </div>

  <!-- JS MINIMO PER LA LANDING -->
  <script>
    const roleBtns = document.querySelectorAll('.role-btn');
    const tipoInput = document.getElementById('tipo_utente');
    const servizioBox = document.getElementById('servizioBox');
    const form = document.getElementById('leadForm');
    const success = document.getElementById('successMessage');
    const servizioLabel = document.getElementById('servizioLabel');
    roleBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        roleBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        tipoInput.value = btn.dataset.role;
        if (btn.dataset.role === 'caregiver') {
          servizioBox.classList.remove('hidden');
          servizioLabel.innerHTML = 'Servizio offerto <span style="color: red;">*</span>';
        } else {
          servizioBox.classList.remove('hidden');
          servizioLabel.innerHTML = 'Servizio richiesto <span style="color: red;">*</span>';
        }
      });
    });

    function normalizzaTelefono(val) {
      val = val.replace(/\s+/g, '');
      if (/^\+39\d{9,10}$/.test(val)) return val;
      if (/^\d{9,10}$/.test(val)) return '+39' + val;
      return null;
    }

    form.addEventListener('submit', async e => {
      e.preventDefault();

      const fd = new FormData(form);

      const prefisso = document.getElementById('prefisso').value;
      const numero = document.getElementById('telefono').value.replace(/\s+/g, '');

      // controllo base: solo cifre, 9â€“10 numeri
      if (!/^\d{9,10}$/.test(numero)) {
        alert('Inserisci un numero di cellulare valido');
        return;
      }

      const telefonoCompleto = prefisso + numero;

      await fetch('https://n8n.webautomat.it/webhook/familynest-landing-page', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          nome: fd.get('nome'),
          email: fd.get('email'),
          telefono: telefonoCompleto,
          citta: fd.get('citta'),
          tipo_utente: tipoInput.value,
          servizio: fd.get('servizio') || '',
          origine: 'landing_pre_lancio'
        })
      });

      form.style.display = 'none';
      let headerForm = document.getElementById('titoloLandingPage');
      headerForm.style.display = 'none';
      success.classList.remove('hidden');
    });
  </script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-02QZ2LKJHW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-02QZ2LKJHW');
  </script>
</body>

</html>